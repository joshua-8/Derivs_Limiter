<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Derivs Limiter: Derivs_Limiter</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Derivs Limiter
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title"><a class="el" href="class_derivs___limiter.html" title="This library can be used to limit the first and second derivative of a variable as it approaches a ta...">Derivs_Limiter</a> </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p ><a class="anchor" id="md_README"></a> <a href="https://github.com/joshua-8/Derivs_Limiter">https://github.com/joshua-8/Derivs_Limiter</a></p>
<p ><a href="https://www.ardu-badge.com/Derivs_Limiter"><img src="https://www.ardu-badge.com/badge/Derivs_Limiter.svg?" alt="arduino-library-badge" style="pointer-events: none;" class="inline"/></a> <a href="https://registry.platformio.org/libraries/joshua1024/Derivs_Limiter"><img src="https://badges.registry.platformio.org/packages/joshua1024/library/Derivs_Limiter.svg" alt="PlatformIO" style="pointer-events: none;" class="inline"/></a></p>
<p ><a href="https://joshua-8.github.io/Derivs_Limiter/html/class_derivs___limiter.html">DETAILED DOCUMENTATION</a> (made with Doxygen)</p>
<p >Please ask any questions <a href="https://github.com/joshua-8/Derivs_Limiter/discussions">here</a>.</p>
<p >This library can be used to limit the first and second derivative of a variable as it approaches a target value.</p>
<p >It's easiest to think of in terms of position, velocity, and acceleration. If used with a servo, for example, the servo will smoothly move to a target value with a trapezoidal velocity profile.</p>
<p >You can also specify how long you want a move to take and the library can calculate the velocity needed to make that happen.</p>
<p >The formula in this program supports being run at uneven intervals, and allows for editing the target, position, and velocity while it runs since it doesn't rely on calculating a motion profile ahead of time.</p>
<h1><a class="anchor" id="autotoc_md1"></a>
Usage:</h1>
<h2><a class="anchor" id="autotoc_md2"></a>
Create a Derivs_Limiter object:</h2>
<p ><code><a class="el" href="class_derivs___limiter.html" title="This library can be used to limit the first and second derivative of a variable as it approaches a ta...">Derivs_Limiter</a> myLimiter = <a class="el" href="class_derivs___limiter.html" title="This library can be used to limit the first and second derivative of a variable as it approaches a ta...">Derivs_Limiter(velocityLimit, accelLimit)</a>;</code></p>
<p ><code><a class="el" href="class_derivs___limiter.html" title="This library can be used to limit the first and second derivative of a variable as it approaches a ta...">Derivs_Limiter</a>(float _velLimit, float _accelLimit, float _target = 0, float _startPos = 0, float _startVel = 0, bool _preventGoingWrongWay = true, bool _preventGoingTooFast = true, float _posLimitLow = -INFINITY, float _posLimitHigh = INFINITY, float _maxStoppingAccel = INFINITY, float* _posPointer = NULL, float* _velPointer = NULL)</code></p>
<p ><em><b>Velocity, position and/or acceleration limits can be set as INFINITY in order to have no limit.</b></em></p>
<h2><a class="anchor" id="autotoc_md3"></a>
quick reference: (&lt;a href="https://joshua-8.github.io/Derivs_Limiter/html/class_derivs___limiter.html" &gt;more detailed reference available here&lt;/a&gt;)</h2>
<p ><code>float calc()</code> <br  />
</p>
<p ><code>float calc(float _target)</code> <br  />
</p>
<p ><code>bool setTarget(float _target)</code> <br  />
</p>
<p ><code>float getTarget()</code> <br  />
</p>
<p ><code>float getPosition()</code> <br  />
</p>
<p ><code>float getVelocity()</code> <br  />
</p>
<p ><code>float getAcceleration()</code></p>
<p ><code>void setPositionVelocity(float pos = 0, float vel = 0)</code> <br  />
</p>
<p ><code>bool setPosition(float pos = 0)</code> <br  />
</p>
<p ><code>bool setVelocity(float vel = 0)</code> <br  />
</p>
<p ><code>bool setVelLimit(float velLim)</code> <br  />
</p>
<p ><code>bool setAccelLimit(float accelLim)</code> <br  />
</p>
<p ><code>float getVelLimit()</code> <br  />
</p>
<p ><code>float getAccelLimit()</code> <br  />
</p>
<p ><code>void setVelAccelLimits(float velLim, float accLim)</code> <br  />
</p>
<p ><code>void setMaxStoppingAccel(float _maxStoppingAccel = INFINITY)</code> <br  />
</p>
<p ><code>float getMaxStoppingAccel()</code> <br  />
</p>
<p ><code>float getLowPosLimit()</code> <br  />
</p>
<p ><code>float getHighPosLimit()</code> <br  />
</p>
<p ><code>bool setLowPosLimit(float lowLimit)</code> <br  />
</p>
<p ><code>bool setHighPosLimit(float highLimit)</code> <br  />
</p>
<p ><code>void setPosLimits(float lowLimit, float highLimit)</code> <br  />
</p>
<p ><code>void resetTime()</code> <br  />
</p>
<p ><code>unsigned long getLastTime()</code> <br  />
</p>
<p ><code>float getTimeInterval()</code> <br  />
</p>
<p ><code>float getTargetDelta()</code> <br  />
</p>
<p ><code>float getLastTarget()</code> <br  />
</p>
<p ><code>float getPositionDelta()</code></p>
<p ><code>float getLastPosition()</code></p>
<p ><code>float getTargetDeltaPerTime()</code> <br  />
</p>
<p ><code>void setPositionPointer(float* _positionPointer)</code> <br  />
</p>
<p ><code>void setVelocityPointer(float* _velocityPointer)</code> <br  />
</p>
<p ><code>bool getPreventGoingWrongWay()</code> <br  />
</p>
<p ><code>void setPreventGoingWrongWay(bool _preventGoingWrongWay)</code> <br  />
</p>
<p ><code>bool getPreventGoingTooFast()</code> <br  />
</p>
<p ><code>void setPreventGoingTooFast(bool _preventGoingTooFast)</code> <br  />
</p>
<p ><code>bool isPosAtTarget()</code> <br  />
</p>
<p ><code>bool isPosNotAtTarget()</code> <br  />
</p>
<p ><code>float distToTarget()</code> <br  />
</p>
<p ><code>void resetVelLimitToOriginal()</code></p>
<p ><code>boolean setVelLimitForTimedMove(float _dist, float _time, float _maxVel = NAN)</code></p>
<p ><code>boolean setTargetAndVelLimitForTimedMove(float _target, float _time, float _maxVel = NAN)</code></p>
<h1><a class="anchor" id="autotoc_md4"></a>
Notes:</h1>
<p >During the part of the profile where velocity is decreased, the acceleration is a bit "spiky" as the code switches back and forth across the threshold for whether or not it needs to start decelerating. Acceleration should not be used directly, only position and velocity are really valid. (Also, note that if the deceleration limit is infinity, this value stays zero when position stops)</p>
<p >NAN (not a number) values are ignored.</p>
<p ><a href="https://gist.github.com/joshua-8/3209f2f400a0e68dead911b8743fc5f0">Here</a> is a Processing sketch that I used to test the formula I wrote for this library. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2
</small></address>
</body>
</html>
